### BJ19236 ì²­ì†Œë…„ìƒì–´

[ğŸ“ë¬¸ì œë³´ê¸°](https://www.acmicpc.net/problem/19236)

---

#### í’€ì´ ì „ì—

- ë¬¼ê³ ê¸°ì˜ ìœ„ì¹˜ì™€ ë°©í–¥, ì¡´ì¬ ì—¬ë¶€ ê°ì²´ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©

```java
  static class Fish {
    int x, y, dir;
    boolean isAlive;

    Fish(int x, int y, int dir, boolean isAlive) {
      this.x = x;
      this.y = y;
      this.dir = dir;
      this.isAlive = isAlive;
    }
  }
```

---

#### ë¬¸ì œí’€ì´

- ê°’ ì…ë ¥ ë°›ê¸°

  - mapì—ëŠ” ë¬¼ê³ ê¸° ë²ˆí˜¸ë¥¼ ì €ì¥

  - fishì—ëŠ” ë¬¼ê³ ê¸° ìˆ˜ ë§Œí¼ Fishê°ì²´ë¥¼ ë§Œë“¤ì–´  ìœ„ì¹˜ì™€ ë°©í–¥ ì €ì¥.

  - ì´ˆê¸° ìƒì–´ ìœ„ì¹˜(sx,sy), ë°©í–¥(sd) ì €ì¥, mapì— ìƒì–´ ìœ„ì¹˜ëŠ” -1ë¡œ ì €ì¥

- dfsí•¨ìˆ˜ì—ì„œ ë¬¼ê³ ê¸°ì™€ ìƒì–´ë¥¼ ì›€ì§ì´ê³  ê²°ê³¼ë¥¼ êµ¬í•œë‹¤.
  1. mapê³¼ fishë¥¼ ë³µì‚¬(copyMap, copyFish)í•´ë‘ê³  ë¬¼ê³ ê¸°ì™€ ìƒì–´ë¥¼ ì´ë™í•œë‹¤.
  2. ë¬¼ê³ ê¸°ë¥¼ ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ ì´ë™ì‹œí‚¨ë‹¤.
     1. ì´ë¯¸ ì£½ì€ ë¬¼ê³ ê¸°ë¼ë©´ ë‹¤ìŒ ìˆœë²ˆ ë¬¼ê³ ê¸°ë¥¼ íƒìƒ‰í•œë‹¤.
     2. ë¬¼ê³ ê¸°ê°€ ì´ë™í•  ìœ„ì¹˜ê°€ ê²½ê³„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šê³ , ë¹ˆì¹¸ì´ê±°ë‚˜ ë°”ê¿€ ë¬¼ê³ ê¸°ê°€ ìˆì„ ê²½ìš°, ë¬¼ê³ ê¸°ì˜ ìœ„ì¹˜ë¥¼ ë³€ê²½ ì €ì¥í•œë‹¤.
     3. ë¬¼ê³ ê¸° ìœ„ì¹˜ë¥¼ ë°”ê¿¨ë‹¤ë©´ ë‹¤ìŒ ë¬¼ê³ ê¸°ë¥¼ íƒìƒ‰í•˜ê³  ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ ë¬¼ê³ ê¸° ë°©í–¥ì„ ë°”ê¿” ì´ë™í•œë‹¤.
  3. ëª¨ë“  ë¬¼ê³ ê¸°ë¥¼ ì´ë™í–ˆë‹¤ë©´ ìƒì–´ë¥¼ ì´ë™ì‹œí‚¨ë‹¤.
  4. ìƒì–´ëŠ” ìµœëŒ€ ì˜®ê¸¸ ìˆ˜ ìˆëŠ” ì´ë™ í¬ê¸°(3)ë§Œí¼ ë°˜ë³µì„ ëŒë¦°ë‹¤.
     1. ìƒì–´ë¥¼ ì´ë™ì‹œí‚¬ ë•Œ ê²½ê³„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šê³ , ë¬¼ê³ ê¸°ê°€ ì—†ëŠ” ë¹ˆì¹¸ì´ ì•„ë‹ ë•Œë§Œ ì´ë™í•œë‹¤.
     2. mapì— ìƒì–´ì˜ ìœ„ì¹˜ë¥¼ ê°±ì‹ í•˜ê³  ìƒì–´ê°€ ì¡ì•„ ë¨¹ì€ ë¬¼ê³ ê¸° ì¡´ì¬ëŠ” false ì‹œí‚¨ë‹¤.
     3. dfs í•¨ìˆ˜ë¡œ ë‹¤ìŒ ë¬¼ê³ ê¸° ì´ë™ê³¼ ìƒì–´ ì´ë™ì„ íƒìƒ‰í•˜ë©° ë¨¹ì€ ë¬¼ê³ ê¸° ë²ˆí˜¸ë¥¼ ë”í•œë‹¤.
     4. ë¬¼ê³ ê¸°ì˜ ìƒíƒœì™€ ì„±ì–´ì˜ ìœ„ì¹˜ë¥¼ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¬ê³  ë‹¤ì‹œ 4-1ë¶€í„° ë°˜ë³µí•œë‹¤.
  5. ìƒì–´ì˜ ì´ë™ì´ ëë‚˜ë©´ ë³µì‚¬í•´ë‘” copyMap, copyFishë¡œ mapê³¼ fishë¥¼ ì´ˆê¸°í™”í•œë‹¤.
  6. ëª¨ë“  ë°˜ë³µì´ ëë‚˜ë©´ ìƒì–´ê°€ ë¨¹ì„ ìˆ˜ ìˆëŠ” ìµœëŒ€ ë¬¼ê³ ê¸° ë²ˆí˜¸ í•©ì„ ì¶œë ¥í•œë‹¤.

---

#### ì „ì²´ ì½”ë“œ

```java
import java.io.*;
import java.util.*;

public class Main {
  static int[] dx = { -1, -1, 0, 1, 1, 1, 0, -1 }; // â†‘, â†–, â†, â†™, â†“, â†˜, â†’, â†—
  static int[] dy = { 0, -1, -1, -1, 0, 1, 1, 1 };
  static int N, map[][], result = 0;
  static Fish[] fish;

  static class Fish {
    int x, y, dir;
    boolean isAlive;

    Fish(int x, int y, int dir, boolean isAlive) {
      this.x = x;
      this.y = y;
      this.dir = dir;
      this.isAlive = isAlive;
    }
  }

  public static void main(String[] args) throws Exception {
    //System.setIn(new FileInputStream("input.txt"));
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    N = 4;
    map = new int[N][N];
    fish = new Fish[N * N + 1]; // ë¬¼ê³ ê¸° ë²ˆí˜¸ 1~16

    for (int i = 0; i < N; i++) {
      StringTokenizer st = new StringTokenizer(br.readLine(), " ");
      for (int j = 0; j < N; j++) {
        int num = Integer.parseInt(st.nextToken());
        int dir = Integer.parseInt(st.nextToken()) - 1; // ë°©í–¥ 1~8ìœ¼ë¡œ ì…ë ¥ ë°›ì•„ì§€ë¯€ë¡œ -1í•´ì„œ 0~7ë¡œ ë§ì¶°ì¤Œ
        fish[num] = new Fish(i, j, dir, true);
        map[i][j] = num;
      }
    }

    int sx = 0, sy = 0; // ìƒì–´ì˜ ìœ„ì¹˜
    int sd = fish[map[0][0]].dir; // ì´ˆê¸° ìƒì–´ì˜ ë°©í–¥
    int eatSum = map[0][0]; // ë¨¹ì€ ë¬¼ê³ ê¸° ë²ˆí˜¸ í•© ì €ì¥ ë³€ìˆ˜ -> (0, 0) ë¬¼ê³ ê¸° ë¨¹ìŒ
    fish[map[0][0]].isAlive = false; // (0, 0) ë¬¼ê³ ê¸° ì£½ìŒ
    map[0][0] = -1; // ìƒì–´ê°€ ìˆëŠ” ìœ„ì¹˜ -1

    dfs(sx, sy, sd, eatSum);

    System.out.println(result);
  }

  private static void dfs(int sx, int sy, int sd, int eatSum) {
    result = Math.max(result, eatSum);

    // ì§€ë„ì™€ ë¬¼ê³ ê¸° ë°°ì—´ ë³µì‚¬
    int[][] copyMap = new int[N][N];
    for (int i = 0; i < map.length; i++) {
      copyMap[i] = map[i].clone();
    }
    Fish[] copyFish = new Fish[fish.length];
    for (int i = 1; i < fish.length; i++) {
      copyFish[i] = new Fish(fish[i].x, fish[i].y, fish[i].dir, fish[i].isAlive);
    }

    // ë¬¼ê³ ê¸° ì›€ì§ì„
    fishMove();

    // ìƒì–´ì´ë™
    for (int i = 1; i < 4; i++) {
      int nx = sx + dx[sd] * i;
      int ny = sy + dy[sd] * i;

      // ê²½ê³„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šê³ , ë¬¼ê³ ê¸°ê°€ ì—†ëŠ” ë¹ˆì¹¸ì´ ì•„ë‹ ê²½ìš°
      if (nx >= 0 && nx < 4 && ny >= 0 && ny < 4 && map[nx][ny] != 0) {
        int eatFishNum = map[nx][ny];
        int nd = fish[eatFishNum].dir;
        map[sx][sy] = 0; // ê¸°ì¡´ ìƒì–´ì˜ ìœ„ì¹˜ëŠ” ì´ë™í–ˆìœ¼ë¯€ë¡œ 0
        map[nx][ny] = -1; // ìƒì–´ê°€ ì´ë™í•œ ìœ„ì¹˜ëŠ” -1
        fish[eatFishNum].isAlive = false; // ìƒì–´ê°€ ì¡ì•„ ë¨¹ì€ ë¬¼ê³ ê¸° ì£½ìŒ

        dfs(nx, ny, nd, eatSum + eatFishNum);

        fish[eatFishNum].isAlive = true; // ë¬¼ê³ ê¸° ìƒíƒœ, ìƒì–´ì˜ ìœ„ì¹˜ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¬ê¸°
        map[sx][sy] = -1;
        map[nx][ny] = eatFishNum;
      }
    }

    // ë§µ ìƒíƒœ, ë¬¼ê³ ê¸° ì •ë³´ ë˜ëŒë¦¬ê¸°
    for (int j = 0; j < map.length; j++)
      System.arraycopy(copyMap[j], 0, map[j], 0, map.length);
    for (int i = 1; i <= 16; i++)
      fish[i] = new Fish(copyFish[i].x, copyFish[i].y, copyFish[i].dir, copyFish[i].isAlive);
  }

  private static void fishMove() {
    for (int i = 1; i <= 16; i++) {
      if (!fish[i].isAlive)
        continue; // ì´ë¯¸ ì£½ì€ ë¬¼ê³ ê¸°ëŠ” íŒ¨ìŠ¤

      int x = fish[i].x;
      int y = fish[i].y;

      for (int d = 0; d < 8; d++) {
        int nextDir = (fish[i].dir + d) % 8;
        int nx = x + dx[nextDir];
        int ny = y + dy[nextDir];

        if (nx >= 0 && nx < 4 && ny >= 0 && ny < 4 && map[nx][ny] != -1) { // ì´ë™í•  ìˆ˜ ìˆë‹¤ë©´
          if (map[nx][ny] == 0) { // ì´ë™í•  ìœ„ì¹˜ê°€ ë¹ˆì¹¸ì¼ ê²½ìš°
            map[x][y] = 0;
            fish[i].x = nx;
            fish[i].y = ny;
          } else { // ë°”ê¿€ ë¬¼ê³ ê¸°ê°€ ìˆì„ê²½ìš°
            int temp = map[nx][ny]; // ë°”ê¿€ ë¬¼ê³ ê¸° ë²ˆí˜¸
            // í˜„ì¬ ë¬¼ê³ ê¸° ìœ„ì¹˜ ë³€ê²½
            fish[i].x = nx;
            fish[i].y = ny;

            map[x][y] = temp;
            fish[temp].x = x;
            fish[temp].y = y;
          }
          map[nx][ny] = i;
          fish[i].dir = nextDir;
          break; // ë¬¼ê³ ê¸° ìœ„ì¹˜ë¥¼ ë°”ê¿¨ë‹¤ë©´ ë°©í–¥ì„ ë” ì´ìƒ ë°”ê¾¸ì§€ ë§ê³  ë‹¤ìŒ ë¬¼ê³ ê¸°ë¡œ
        }
      }
    }
  }
}
```
