## [ğŸ§™ğŸ»â€â™€ï¸](https://www.acmicpc.net/problem/20058) [bj20058] ë§ˆë²•ì‚¬ ìƒì–´ì™€ íŒŒì´ì–´ìŠ¤í†°

> **ì†Œìš” ì‹œê°„: 65ë¶„<br>
> ë©”ëª¨ë¦¬: 18584KB<br>
> ì‹œê°„: 244ms**

## ë¬¸ì œ ì ‘ê·¼

- í•´ê²°í•´ì•¼í•˜ëŠ” ë¬¸ì œê°€ ë§ì•„ì„œ ë‹¨ê³„ë³„ë¡œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©
- ë©”ëª¨ë¦¬ë¥¼ ì ê²Œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ê³µìš©ìœ¼ë¡œ ì“¸ ìˆ˜ ìˆëŠ”ê±´ ì „ì—­ë³€ìˆ˜ë‚˜ ì¸ìë¡œ ë„£ì–´ì„œ ì¬í™œìš©í•¨

## ë¬¸ì œ í’€ì´

1. Lë‹¨ê³„ì—ì„œ ê²©ìë¡œ ë‚˜ëˆˆ ë¸”ëŸ­ë³„ë¡œ 90ë„ íšŒì „

2. ì™„ì „íƒìƒ‰ê³¼ ì‚¬ë°©íƒìƒ‰ì„ ì‚¬ìš©í•´ ì–¼ìŒì„ 1 ë…¹ì¼ ìœ„ì¹˜ë¥¼ ì°¾ì•„ëƒ„

3. íŒŒì´ì–´ìŠ¤í†°ì´ ëë‚˜ë©´ bfsë¥¼ ì´ìš©í•´ ì–¼ìŒ ìˆ˜ì™€ ì œì¼ í° ë©ì–´ë¦¬ í¬ê¸°ë¥¼ êµ¬í•´ ì¶œë ¥í•¨

## ì „ì²´ ì½”ë“œ

```java
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.LinkedList;
import java.util.Queue;
import java.util.StringTokenizer;

public class Main_bj20058 {
    static final int[] di = {-1, 0, 1, 0};
    static final int[] dj = {0, 1, 0, -1};
    static int Q, pow2N;
    static int[][] map;
    static int[] order;
    static boolean[][] check;

    public static void main(String args[]) throws Exception {
        init();
        play();
        print();
    }

    static void play() {
        for (int q = 0; q < Q; q++) {
            firestorm(order[q]);
        }
    }

    static void firestorm(int L) {
        int pow2L = (int) Math.pow(2, L);
        int[][] tmp = new int[pow2L][pow2L];
        for (int i = 0; i < pow2N; i += pow2L) {
            for (int j = 0; j < pow2N; j += pow2L) {
                rotate90(pow2L, i, j, tmp);
            }
        }
        melt();
    }

    static void melt() {
        for (int i = 0; i < pow2N; i++) {
            for (int j = 0; j < pow2N; j++) {
                if (map[i][j] == 0) continue;
                int cnt = 0;
                for (int z = 0; z < 4; z++) {
                    int ni = i + di[z];
                    int nj = j + dj[z];
                    if (ni >= 0 && ni < pow2N && nj >= 0 && nj < pow2N && map[ni][nj] > 0) {
                        cnt++;
                    }
                }
                if (cnt < 3) check[i][j] = true;
            }
        }

        for (int i = 0; i < pow2N; i++) {
            for (int j = 0; j < pow2N; j++) {
                if (check[i][j]) {
                    map[i][j]--;
                    check[i][j] = false;
                }
            }
        }
    }

    static void rotate90(int len, int st_i, int st_j, int[][] tmp) {
        for (int i = 0; i < len; i++) {
            for (int j = 0; j < len; j++) {
                tmp[j][len - 1 - i] = map[st_i + i][st_j + j];
            }
        }
        for (int i = 0; i < len; i++) {
            for (int j = 0; j < len; j++) {
                map[st_i + i][st_j + j] = tmp[i][j];
            }
        }
    }

    static void print() {
        int sum = 0;
        int max = 0;
        Queue<int[]> queue = new LinkedList<>();
        for (int i = 0; i < pow2N; i++) {
            for (int j = 0; j < pow2N; j++) {
                if (map[i][j] > 0 && !check[i][j]) {
                    int cnt = 1;
                    check[i][j] = true;
                    sum += map[i][j];
                    queue.offer(new int[]{i, j});
                    while (!queue.isEmpty()) {
                        int[] node = queue.poll();
                        for (int z = 0; z < 4; z++) {
                            int ni = node[0] + di[z];
                            int nj = node[1] + dj[z];
                            if (ni >= 0 && ni < pow2N && nj >= 0 && nj < pow2N && !check[ni][nj] && map[ni][nj] > 0) {
                                cnt++;
                                check[ni][nj] = true;
                                sum += map[ni][nj];
                                queue.offer(new int[]{ni, nj});
                            }
                        }
                    }
                    if (cnt > 1 && max < cnt) max = cnt;
                }
            }
        }

        System.out.println(sum);
        System.out.println(max);
    }

    static void init() throws Exception {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        StringTokenizer st = new StringTokenizer(br.readLine(), " ");

        int N = Integer.parseInt(st.nextToken());
        Q = Integer.parseInt(st.nextToken());
        pow2N = (int) Math.pow(2, N);
        map = new int[pow2N][pow2N];
        check = new boolean[pow2N][pow2N];

        for (int i = 0; i < pow2N; i++) {
            st = new StringTokenizer(br.readLine(), " ");
            for (int j = 0; j < pow2N; j++) {
                map[i][j] = Integer.parseInt(st.nextToken());
            }
        }

        order = new int[Q];
        st = new StringTokenizer(br.readLine(), " ");
        for (int q = 0; q < Q; q++) order[q] = Integer.parseInt(st.nextToken());

        br.close();
    }

}
```
