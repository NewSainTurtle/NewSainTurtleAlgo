# [bj21610] ë§ˆë²•ì‚¬ ìƒì–´ì™€ ë¹„ë°”ë¼ê¸°

ğŸ“– [ë¬¸ì œ ë°”ë¡œê°€ê¸°](https://www.acmicpc.net/problem/21610)



----

### ë¬¸ì œ í’€ì´

1. ì´ˆê¸° êµ¬ë¦„ ìœ„ì¹˜ì— booleaní˜• ë°°ì—´ `cloud`ì— true ê°’ì„ ì €ì¥í•œë‹¤.

2. êµ¬ë¦„ ì´ë™ íšŸìˆ˜ë§Œí¼ ë¹„ë°”ë¼ê¸° ë©”ì†Œë“œ `magic()`ì„ ì‹¤í–‰í•œë‹¤.

   2-1.	ë°°ì—´ `cloud`ì—ì„œ ê°’ì´ trueì¸ ê²½ìš°ì—ë§Œ êµ¬ë¦„ì„ ì´ë™ì‹œí‚¨ë‹¤. (Në²ˆì—´ ì˜¤ë¥¸ìª½ì—ëŠ” 1ë²ˆì—´, 1ë²ˆì—´ ì™¼ìª½ì—ëŠ” Në²ˆì—´ì´ ìˆë„ë¡ ì´ë™ì‹œí‚¨ë‹¤.)

   2-2.	ì´ë™í•œ ìœ„ì¹˜ê°’ì„ í `queue`ì— ë„£ê³ , í•´ë‹¹ ìœ„ì¹˜ì— ë¬¼ì˜ ì–‘ì„ 1 ì¦ê°€ì‹œí‚¨ë‹¤.

   2-3.	`queue`ê°€ ë¹Œ ë•Œê¹Œì§€ ê°’ì„ êº¼ë‚´ë©° while ë°˜ë³µë¬¸ì„ ëŒë©´ì„œ, êµ¬ë¦„ì´ ìˆë˜ ìœ„ì¹˜ì˜ ëŒ€ê°ì„ ì— ë¬¼ì´ ìˆëŠ” ìˆ˜ë§Œí¼ í•´ë‹¹ ìœ„ì¹˜ì˜ ë¬¼ì˜ ì–‘ì„ ì¦ê°€ì‹œí‚¨ë‹¤.

   2-4.	êµ¬ë¦„ì´ ìˆë˜ ìœ„ì¹˜ë¥¼ ì œì™¸í•˜ê³  ë¬¼ì˜ ì–‘ì´ 2 ì´ìƒì¸ ë°”êµ¬ë‹ˆì— êµ¬ë¦„ì´ ìƒê¸°ê²Œ í•˜ê³ , ë¬¼ì˜ ì–‘ì„ 2ë§Œí¼ ì¤„ì¸ë‹¤. `cloud` ë°°ì—´ì„ ìˆœíšŒí•˜ë©° ê³„ì‚°í•œë‹¤.

3. êµ¬ë¦„ì„ ëª¨ë‘ ì´ë™ì‹œí‚¨ ë’¤ ë¬¼ì˜ ì–‘ì´ ë“¤ì–´ ìˆëŠ” ë°°ì—´ `map`ì˜ ì „ì²´ í•©ì„ ê³„ì‚°í•˜ì—¬ ë¬¼ì˜ ì–‘ì˜ í•©ì„ ì¶œë ¥í•œë‹¤.



----

### ì†ŒìŠ¤ ì½”ë“œ

```java
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.LinkedList;
import java.util.Queue;
import java.util.StringTokenizer;

public class bj21610_ë§ˆë²•ì‚¬ìƒì–´ì™€ë¹„ë°”ë¼ê¸° {
	
	static int N, M;
	static int[][] map;
	static boolean[][] cloud;
	static Queue<Point> queue;
	
	static int[] di = {0, 0, -1, -1, -1, 0, +1, +1, +1};
	static int[] dj = {0, -1, -1, 0, +1, +1, +1, 0, -1};
	
	public static void main(String[] args) throws Exception {
		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
		StringTokenizer st = new StringTokenizer(br.readLine());
		
		N = Integer.parseInt(st.nextToken());
		M = Integer.parseInt(st.nextToken());
		
		map = new int[N+1][N+1];
		cloud = new boolean[N+1][N+1];
		
		queue = new LinkedList<>();
		
		for(int i=1; i<=N; i++) {
			st = new StringTokenizer(br.readLine());
			for(int j=1; j<=N; j++) {
				map[i][j] = Integer.parseInt(st.nextToken());
			}
		}
		
		for(int i=N-1; i<=N; i++) {
			for(int j=1; j<=2; j++) {
				cloud[i][j] = true;
			}
		}
		
		for(int i=0; i<M; i++) {
			st = new StringTokenizer(br.readLine());
			int d = Integer.parseInt(st.nextToken());
			int s = Integer.parseInt(st.nextToken());
			
			magic(d, s);
		}
		
		int sum = 0;
		for(int i=1; i<=N; i++) {
			for(int j=1; j<=N; j++) {
				sum += map[i][j];
			}
		}
		
		System.out.println(sum);
		
	}
	
	public static void magic(int d, int s) {
		
		for(int i=1; i<=N; i++) {
			for(int j=1; j<=N; j++) {
				int moveR = 0, moveC = 0;
				
				if(cloud[i][j]) {
					if(i + di[d] * s <= 0) {
						moveR = (i + (di[d] * s)) +  (N * ((-1) * (i + (di[d] * s)) / N + 1));
						if(moveR == 0) moveR = N;
					} else if(i + di[d] * s > N) {
						moveR = (i + di[d] * s) % N;
						if(moveR == 0) moveR = N;
					} else {
						moveR = i + di[d] * s;
					}
					
					if(j + dj[d] * s <= 0) {
						moveC = (j + (dj[d] * s)) +  (N * ((-1) * (j + (dj[d] * s)) / N + 1));
						if(moveC == 0) moveC = N;
					} else if(j + dj[d] * s > N) {
						moveC = (j + dj[d] * s) % N;
						if(moveC == 0) moveC = N;
					} else {
						moveC = j + dj[d] * s;
					}
					
					cloud[i][j] = false;
					queue.offer(new Point(moveR, moveC));
					map[moveR][moveC]++;
					
				} else continue;
				
			}
		}
		
		int[][] tempArr = new int[N+1][N+1];
		
		while(!queue.isEmpty()) {
			
			Point point = queue.poll();
			cloud[point.r][point.c] = true;
			
			int count = 0;
			
			for(int k=2; k<di.length; k=k+2) {
				int nextR = point.r + di[k];
				int nextC = point.c + dj[k];
				
				if(nextR>0 && nextR<=N && nextC>0 && nextC<=N && map[nextR][nextC]>0) {
					count++;
				}
			}
			
			tempArr[point.r][point.c] += count;
		}
		
		for(int i=1; i<=N; i++) {
			for(int j=1; j<=N; j++) {
				map[i][j] += tempArr[i][j];
			}
		}	
			
		for(int i=1; i<=N; i++) {
			for(int j=1; j<=N; j++) {
				if(map[i][j] >= 2 && !cloud[i][j]) {
					cloud[i][j] = true;
					map[i][j] -= 2;
					
				} else if(cloud[i][j]) 
					cloud[i][j] = false;
			}
		}
	}
	
	public static class Point {
		private int r;
		private int c;
		
		public Point(int r, int c) {
			this.r = r;
			this.c = c;
		}
	}
}
```

