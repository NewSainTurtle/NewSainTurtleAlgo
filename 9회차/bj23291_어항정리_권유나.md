## [ðŸ ](https://www.acmicpc.net/problem/23291) [bj23291] ì–´í•­ ì •ë¦¬

> **ì†Œìš” ì‹œê°„: 307ë¶„<br>
> ë©”ëª¨ë¦¬: 11868KB<br>
> ì‹œê°„: 84ms**

## ë¬¸ì œ ì ‘ê·¼

- ë¬¸ì œì—ì„œ ì›í•˜ëŠ” ë¡œì§ì´ ë§Žì•„ì„œ ìˆœì„œëŒ€ë¡œ ì°¨ê·¼ì°¨ê·¼ í’€ì–´ê°€ì•¼í•œë‹¤.
- ì–´í•­ì„ 90ë„ íšŒì „í•˜ê±°ë‚˜, 180ë„ íšŒì „í• ë•Œ ë°°ì—´ì— ìž˜ ì €ìž¥ì‹œì¼œì•¼í•œë‹¤. í™•ì¸í•˜ë©´ì„œ ë¬¸ì œ í’€ê¸°!

## ë¬¸ì œ í’€ì´

1. ì¼ì°¨ì› ë°°ì—´ `fishbowl`ì— ì¼ë ¬ë¡œ ì €ìž¥ëœ ì–´í•­ì˜ ì´ˆê¸°ê°’ì„ ì €ìž¥í•œë‹¤. ìž…ë ¥ì„ ë°›ìœ¼ë©´ì„œ ì–´í•­ì˜ ë¬¼ê³ ê¸° ìµœëŒ€ê°’ max, ìµœì†Œê°’ minì„ êµ¬í•œë‹¤.

2. `round`ë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”ì‹œí‚¨ë‹¤. `tmp_fishbowl`ëŠ” ì–´í•­ì„ ì´ì°¨ì›ìœ¼ë¡œ ìŒ“ì„ë•Œ ì €ìž¥í•  ë°°ì—´ì´ë‹¤. `tmp_moves`ëŠ” ì´ë™í•  ë¬¼ê³ ê¸°ë“¤ì„ ìž„ì‹œ ì €ìž¥í•  ë°°ì—´ì´ë‹¤.

3. í˜„ìž¬ ì–´í•­ì˜ ìµœëŒ€ê°’ê³¼ ìµœì†Œê°’ì˜ ì°¨ê°€ Kë³´ë‹¤ ìž‘ê±°ë‚˜ ê°™ì„ë•Œê¹Œì§€ ë°˜ë³µí•œë‹¤. ë§¤ ë°˜ë³µë§ˆë‹¤ roundë¥¼ 1 ì¦ê°€ì‹œí‚¨ë‹¤. (3-10)

4. `insertFish`ì—ì„œëŠ” ë¬¼ê³ ê¸° ìˆ˜ê°€ ì œì¼ ì ì€ ì–´í•­ì— ë¬¼ê³ ê¸°ë¥¼ 1ë§ˆë¦¬ ë„£ì–´ì¤€ë‹¤.

5. `stackFishbowl1`ì—ì„œëŠ” íƒ€ê²Ÿí•œ ì–´í•­ì„ 90ë„ë¡œ ëŒë¦¬ê³  ë°”ë‹¥ì— ìžˆëŠ” ì–´í•­ ìœ„ë¡œ ìŒ“ëŠ”ë‹¤. ì´ë¥¼ ìŒ“ëŠ” ì–´í•­ì˜ ë§¨ ì˜¤ë¥¸ìª½ì´ ë°”ë‹¥ì— ìžˆëŠ” ì–´í•­ì„ ë„˜ì–´ì„œê¸° ì „ê¹Œì§€ ë°˜ë³µí•œë‹¤.

6. `moveFish`ì—ì„œëŠ” ì™„ì „íƒìƒ‰ì„ í†µí•´ ìžì‹ ì˜ ì˜¤ë¥¸ìª½ê³¼ ì•„ëž˜ì— ì¸ì ‘í•œ ì–´í•­ì„ ìˆœì°¨ì ìœ¼ë¡œ í™•ì¸í•œë‹¤. ìžì‹ ê³¼ í™•ì¸í•˜ëŠ” ì–´í•­ì˜ ë¬¼ê³ ê¸° ìˆ˜ë¥¼ ë”í•œ í›„ 5ë¡œ ë‚˜ëˆˆ ëª«ë§Œí¼ì˜ ë¬¼ê³ ë¦¬ë¥¼ ë¬¼ê³ ê¸° ìˆ˜ê°€ ë§Žì€ ìª½ì—ì„œ ì ì€ ìª½ìœ¼ë¡œ ì´ë™ì‹œí‚¨ë‹¤. ì´ë•Œ ë™ì‹œì— ì´ë¤„ì ¸ì•¼í•˜ê¸° ë•Œë¬¸ì— tmp_movesì— ìž„ì‹œë¡œ ì €ìž¥í•œë‹¤.

7. `flatFishbowl`ì—ì„œëŠ” `moveFish`ì—ì„œ ì¡°ì ˆí•œ ë¬¼ê³ ê¸° ìˆ˜ë¥¼ ë°˜ì˜í•˜ë©´ì„œ ì–´í•­ì„ ì¼ë ¬ë¡œ ë§Œë“¤ì–´ fishbowlì— ì €ìž¥í•œë‹¤.

8. `stackFishbowl2`ì—ì„œëŠ” ì–´í•­ì˜ ì ˆë°˜ ì¤‘ ì•žë¶€ë¶„ì„ 180ë„ë¡œ ëŒë¦¬ê³  ë°”ë‹¥ì— ìžˆëŠ” ì–´í•­ ìœ„ë¡œ ìŒ“ëŠ”ë‹¤. ì´ë¥¼ 2ë²ˆ ë°˜ë³µí•œë‹¤.

9. `moveFish`ë¡œ ë¬¼ê³ ê¸° ìˆ˜ë¥¼ ì¡°ì ˆí•˜ê³ , `flatFishbowl`ë¡œ ì–´í•­ì„ ì¼ë ¬ë¡œ ë§Œë“ ë‹¤.

10. `checkMinMax`ë¥¼ í†µí•´ í˜„ìž¬ ì–´í•­ì˜ ë¬¼ê³ ê¸° ìµœëŒ€ê°’, ìµœì†Œê°’ì„ êµ¬í•œë‹¤.

11. roundë¥¼ ì¶œë ¥í•œë‹¤.

## ì „ì²´ ì½”ë“œ

```java
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.StringTokenizer;

public class Main_bj23291 {
    static int N, K;
    static int min, max;
    static int[] fishbowl;
    static final int[] di = {0, 1};
    static final int[] dj = {1, 0};

    public static void main(String args[]) throws Exception {
        init();

        int round = 0;
        int[][] tmp_fishbowl = new int[N][N];
        int[][] tmp_moves = new int[N][N];

        while (max - min > K) {
            round++;
            insertFish();
            int[] HI = stackFishbowl1(tmp_fishbowl);
            moveFish(N - 1 - HI[0], HI[1], tmp_fishbowl, tmp_moves);
            flatFishbowl(tmp_fishbowl, tmp_moves);
            HI = stackFishbowl2(tmp_fishbowl);
            moveFish(N - HI[0], HI[1], tmp_fishbowl, tmp_moves);
            flatFishbowl(tmp_fishbowl, tmp_moves);
            checkMinMax();
        }
        System.out.println(round);
    }

    static void init() throws Exception {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        StringTokenizer st = new StringTokenizer(br.readLine(), " ");

        N = Integer.parseInt(st.nextToken());
        K = Integer.parseInt(st.nextToken());

        fishbowl = new int[N];
        max = 0;
        min = 10001;
        st = new StringTokenizer(br.readLine(), " ");

        for (int f = 0; f < N; f++) {
            fishbowl[f] = Integer.parseInt(st.nextToken());
            if (fishbowl[f] < min) min = fishbowl[f];
            else if (max < fishbowl[f]) max = fishbowl[f];
        }
    }

    static void insertFish() {
        for (int f = 0; f < N; f++) {
            if (fishbowl[f] == min) fishbowl[f]++;
        }
    }

    static int[] stackFishbowl1(int[][] tmp_fishbowl) {
        tmp_fishbowl[N - 1] = fishbowl.clone();

        int height = 1, width = 1;
        int remain = N - 1;
        int idx = 0;

        while (remain >= height) {
            int tmp_h = N - 1;
            for (int w = width - 1; w >= 0; w--) {
                tmp_h--;
                for (int h = 1; h <= height; h++) {
                    tmp_fishbowl[tmp_h][idx + width - 1 + h] = tmp_fishbowl[N - h][idx + w];
                    tmp_fishbowl[N - h][idx + w] = 0;
                }
            }
            idx += width;
            width = height;
            height = N - tmp_h;
            remain -= width;
        }

        return new int[]{height, idx};
    }

    static void moveFish(int i_len, int j_len, int[][] tmp_fishbowl, int[][] tmp_moves) {
        for (int j = j_len; j < N; j++) {
            for (int i = i_len; i < N; i++) {
                if (tmp_fishbowl[i][j] > 0) {
                    for (int z = 0; z < 2; z++) {
                        int ni = i + di[z];
                        int nj = j + dj[z];
                        if (ni < N && nj < N && tmp_fishbowl[ni][nj] > 0 && tmp_fishbowl[i][j] != tmp_fishbowl[ni][nj]) {
                            if (tmp_fishbowl[ni][nj] > tmp_fishbowl[i][j]) {
                                int fish = (tmp_fishbowl[ni][nj] - tmp_fishbowl[i][j]) / 5;
                                tmp_moves[ni][nj] -= fish;
                                tmp_moves[i][j] += fish;
                            } else {
                                int fish = (tmp_fishbowl[i][j] - tmp_fishbowl[ni][nj]) / 5;
                                tmp_moves[i][j] -= fish;
                                tmp_moves[ni][nj] += fish;
                            }
                        }
                    }
                }
            }
        }
    }

    static void flatFishbowl(int[][] tmp_fishbowl, int[][] tmp_moves) {
        int idx_fishbowl = 0;
        for (int j = 0; j < N; j++) {
            for (int i = N - 1; i >= 0; i--) {
                if (tmp_fishbowl[i][j] > 0) {
                    fishbowl[idx_fishbowl++] = tmp_fishbowl[i][j] + tmp_moves[i][j];
                    tmp_moves[i][j] = 0;
                    tmp_fishbowl[i][j] = 0;
                }
            }
        }
    }

    static int[] stackFishbowl2(int[][] tmp_fishbowl) {
        tmp_fishbowl[N - 1] = fishbowl.clone();

        int height = 1;
        int width = N;
        int idx = 0;

        for (int r = 0; r < 2; r++) {
            for (int h = 0; h < height; h++) {
                for (int w = 0; w < width / 2; w++) {
                    tmp_fishbowl[N - 1 - height - h][idx + width / 2 + w] =
                            tmp_fishbowl[N - height + h][idx + width / 2 - 1 - w];
                    tmp_fishbowl[N - height + h][idx + width / 2 - 1 - w] = 0;
                }
            }
            width = width / 2;
            height = height * 2;
            idx += width;
        }
        return new int[]{height, idx};
    }

    static void checkMinMax() {
        max = 0;
        min = 10001;
        for (int f = 0; f < N; f++) {
            if (fishbowl[f] > 0 && fishbowl[f] < min) min = fishbowl[f];
            if (max < fishbowl[f]) max = fishbowl[f];
        }
    }
}
```
